{"remainingRequest":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\src\\components\\User\\UserInfo.vue?vue&type=style&index=0&id=e911db06&lang=less&scoped=true&","dependencies":[{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\src\\components\\User\\UserInfo.vue","mtime":1578115287724},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\less-loader\\dist\\cjs.js","mtime":1576755764101},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n",{"version":3,"sources":["UserInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAySA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserInfo.vue","sourceRoot":"src/components/User","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<!-- 导航 -->\r\n\t\t<Breadcrumb :value=\"common\"></Breadcrumb>\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<el-row class=\"checking\">\r\n\t\t\t\t<el-col :span=\"19\">\r\n\t\t\t\t\t<div class=\"grid-content bg-purple\">\r\n\t\t\t\t\t\t<span class=\"com_title\">Reader name：</span>\r\n\t\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t\tclass=\"codeName\"\r\n\t\t\t\t\t\t\tref=\"com_name\"\r\n\t\t\t\t\t\t\tplaceholder=\"Please enter name\"\r\n\t\t\t\t\t\t\tv-model=\"input1\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tclearable\r\n\t\t\t\t\t\t\t@clear=\"clear\"\r\n\t\t\t\t\t\t></el-input>\r\n\t\t\t\t\t\t<span class=\"com_title\">Reader barcode：</span>\r\n\t\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t\tclass=\"codeName\"\r\n\t\t\t\t\t\t\tref=\"com_name\"\r\n\t\t\t\t\t\t\tplaceholder=\"Please enter barcode\"\r\n\t\t\t\t\t\t\tv-model=\"value1\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@clear=\"clear\"\r\n\t\t\t\t\t\t\tclearable\r\n\t\t\t\t\t\t></el-input>\r\n\t\t\t\t\t\t<el-button type=\"info\" size=\"small\" @click=\"searchClick\">Query</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-col>\r\n\t\t\t\t<el-col :span=\"5\">\r\n\t\t\t\t\t<div class=\"grid-content bg-purple-light\">\r\n\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\ttype=\"info\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@click=\"dialogFormVisible = true\"\r\n\t\t\t\t\t\t\tclass=\"add\"\r\n\t\t\t\t\t\t>New reader information</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-col>\r\n\t\t\t</el-row>\r\n\t\t\t<el-table :data=\"tableData\" style=\"width: 100%\">\r\n\t\t\t\t<el-table-column prop=\"name\" label=\"Reader name\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"barcode\" label=\"Reader barcode\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"memberType\" label=\"Occupation\"></el-table-column>\r\n\t\t\t\t<el-table-column label=\"Operation\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-button size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">Edit</el-button>\r\n\t\t\t\t\t\t<el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.$index, scope.row)\">Delete</el-button>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<el-pagination\r\n\t\t\t\tv-if=\"show\"\r\n\t\t\t\tclass=\"page_size\"\r\n\t\t\t\tbackground=\"\"\r\n\t\t\t\tlayout=\"prev, pager, next\"\r\n\t\t\t\t:page-size=\"pageSize\"\r\n\t\t\t\t:current-page=\"currentPage\"\r\n\t\t\t\t@current-change=\"handleCurrentChange\"\r\n\t\t\t\t:total=\"allCount\"\r\n\t\t\t></el-pagination>\r\n\t\t\t<el-dialog title=\"add Reader\" :visible.sync=\"dialogFormVisible\">\r\n\t\t\t\t<el-form :model=\"addForm\" :rules=\"rules\" ref=\"addForm\">\r\n\t\t\t\t\t<el-form-item label=\"reader name\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"addForm.name\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"occupation\" prop=\"memberType\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"addForm.memberType\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t\t<el-button size=\"small\" @click=\"dialogFormVisible = false\">cancel</el-button>\r\n\t\t\t\t\t<el-button size=\"small\" type=\"info\" @click=\"submitForm('addForm')\">confirm</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t</el-dialog>\r\n\t\t\t<el-dialog title=\"edit\" :visible.sync=\"editFormVisible\">\r\n\t\t\t\t<el-form :model=\"editRegion\" :rules=\"rules\" ref=\"editRegion\">\r\n\t\t\t\t\t<el-form-item label=\"reader name\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"editRegion.name\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"occupation\" prop=\"memberType\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"editRegion.memberType\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t\t<el-button size=\"small\" @click.native=\"editFormVisible = false\">cancel</el-button>\r\n\t\t\t\t\t<el-button size=\"small\" type=\"info\" @click=\"editSubmitRegion('editRegion')\">confirm</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t</el-dialog>\r\n\t\t</el-card>\r\n\t</div>\r\n</template>\r\n<script>\r\n  import {allUser_api,getUser_api,addUser_api,editUser_api,deleteUser_api} from '@/api'\r\n  import moment from 'moment' // 时间过滤插件\r\nexport default {\r\n  data() {\r\n    return {\r\n      common: ['Reader information management'], //公共组件传值\r\n      input1:'',\r\n      value1:'',\r\n      allCount:null,\r\n        currentPage:1,\r\n        pageSize:10,\r\n        tableData: [],\r\n        dialogFormVisible:false,\r\n      editFormVisible: false,\r\n      show:true,\r\n\t\t\taddForm:{\r\n\t\t\t\tname:'',\r\n\t\t\t\tmemberType:'',\r\n\t\t\t},\r\n\t\t\teditRegion: {\r\n\t\t\t\tname:'',\r\n\t\t\t\tmemberType:''\r\n\t\t\t},\r\n\t\t\tformLabelWidth:'140px',\r\n\t\t\trules:{\r\n\t\t\t\tname:[{required:true,message:'Please input the title',trigger:'blur'}],\r\n\t\t\t\tbarcode:[{required:true,message:'Please input number',trigger:'blur'},\r\n\t\t\t\t\t\t\t{type: 'string',\r\n\t\t\t\t\t\t\tpattern:  /^[0-9]{1,22}$/,//正则表达式验证\r\n\t\t\t\t\t\t\tmessage: 'Please enter a number number！',\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t}],\r\n\t\t\t\tmemberType:[{required:true,message:'Please input author',trigger:'blur'}]\r\n\t\t\t},\r\n    }\r\n  },\r\n  created() {\r\n    this.getUserAll()\r\n  },\r\n  methods: {\r\n\t  // 清除clearInput\r\n    clear(){\r\n      this.show = true;\r\n        this.getUserAll()\r\n    },\r\n    async getUserAll() {\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await allUser_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n    //分页\r\n    async handleCurrentChange(currentPage){\r\n      this.currentPage = currentPage;\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await allUser_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n\t\t//add\r\n\t\tsubmitForm(formName){\r\n\t\t    var that = this\r\n\t\t\tthis.$refs[formName].validate((valid) =>{\r\n\t\t\t\tif(valid){\r\n\t\t\t\t\tvar params ={\r\n            \"userName\": that.addForm.name,\r\n            \"memberType\": that.addForm.memberType\r\n          }\r\n\r\n\t\t\t\t\tthis.$confirm('Whether to commit',{\r\n\t\t\t\t\t\tconfirmButtonText:'confirm',\r\n\t\t\t\t\t\tcancelButtonText:'cancel',\r\n\t\t\t\t\t\ttype:'warning',\r\n\t\t\t\t\t\tcenter:true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(function(){\r\n\t\t\t\t\t\t//ajax\r\n\t\t\t\t\t\taddUser_api(params).then(res =>{\r\n\t\t\t\t\t\t\tif(res.data.status == 200){ //此处的表单验证\r\n\t\t\t\t\t\t\t\tthat.dialogFormVisible = false\r\n\t\t\t\t\t\t\t\tthat.getUserAll() //重新渲染数据\r\n\t\t\t\t\t\t\t}else{\r\n                that.$confirm(res.data.msg, 'hint', {\r\n\t\t                  type: 'warning'\r\n\t\t            })\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).catch(err =>{console.log(err)})\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(function(err){\r\n\t\t\t\t\t\tconsole.log('Cancel')\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//edit\r\n\t\thandleEdit(index, row) {\r\n\t\t    this.editFormVisible = true;\r\n\t\t    this.editRegion = Object.assign({name: row.name,barcode:row.barcode,memberType: row.memberType,userId: row.id}); //这句是关键！！！\r\n\t\t},\r\n\t\teditSubmitRegion (formName) {\r\n\t\t\tvar that = this\r\n\t\t\tthis.$refs[formName].validate((valid) =>{\r\n\t\t\t\tif(valid){\r\n          var params ={\r\n            userName: that.editRegion.name,\r\n            memberType: that.editRegion.memberType,\r\n            userId: that.editRegion.userId\r\n          }\r\n\t\t\t\t\tthis.$confirm('Whether to commit',{\r\n\t\t\t\t\t\tconfirmButtonText:'confirm',\r\n\t\t\t\t\t\tcancelButtonText:'cancel',\r\n\t\t\t\t\t\ttype:'warning',\r\n\t\t\t\t\t\tcenter:true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(function(){\r\n\t\t\t\t\t\t//ajax\r\n\t\t\t\t\t\teditUser_api(params).then(res =>{\r\n\t\t\t\t\t\t\tif(res.data.status == 200){\r\n\t\t\t\t\t\t\t\tthat.editFormVisible = false\r\n\t\t\t\t\t\t\t\tthat.getUserAll() //重新渲染数据\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthat.$confirm(res.data.msg, 'hint', {\r\n\t\t                  type: 'warning'\r\n\t\t             \t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).catch(err =>{console.log(err)})\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(function(err){\r\n\t\t\t\t\t\tconsole.log('Cancel')\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//query\r\n\t\tsearchClick(){ // 查询功能\r\n\t\t\tconst nameCom = this.input1; //读者名字\r\n\t\t\tconst cardCom = this.value1; // 读者编号\r\n      if(nameCom == '' && cardCom == ''){\r\n        this.show = true;\r\n        this.getUserAll()\r\n      }else{\r\n        var  params = {\r\n          \"userName\": nameCom,\r\n          \"userBarcode\": parseInt(cardCom)\r\n        }\r\n        getUser_api(params).then(res => {\r\n          if (res.data.status !== 200) {\r\n            return this.$message.error(res.data.msg)\r\n          } else {\r\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\r\n            var arr = []\r\n            arr.push(res.data.data)\r\n            this.tableData = arr\r\n            this.show = false;\r\n          }\r\n        })\r\n      }\r\n\r\n\t\t},\r\n\t\t//delete\r\n\t\thandleDelete (index,row) {\r\n\t\t    var _self = this;\r\n\t\t    this.$confirm('Are you sure to delete?', 'hint', {\r\n\t\t        confirmButtonText:'delete',\r\n\t\t\t\t\t  cancelButtonText:'waiting',\r\n\t\t\t\t\t  type:'warning',\r\n\t\t\t\t\t  center:true\r\n\t\t\t\t\t\t  }).then(function(){\r\n\t\t\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\t\t\tuserId:row.id\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdeleteUser_api({data:params}).then(res => {\r\n\t\t\t\t\t\t\t\tif(res.status == 200){\r\n\t\t\t\t\t\t\t\t\t_self.$message({\r\n\t\t\t\t\t\t\t\t\t  message: 'successfully delete',\r\n\t\t\t\t\t\t\t\t\t  type: 'success'\r\n\t\t\t\t\t\t\t\t  });\r\n\t\t\t\t\t\t\t_self.getUserAll() //重新渲染数据\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err =>{console.log(err)})\r\n\t\t\t\t\t\t  }).catch(function(e){\r\n\t\t\t\t\t\t\t  if(e != \"cancel\")\r\n\t\t\t\t\t\t\t\t  console.log(\"error:\" + e);\r\n\t\t\t\t\t\t  });\r\n\t\t\t\t  },\r\n\t},\r\n  mounted() {}\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n</style>\r\n"]}]}