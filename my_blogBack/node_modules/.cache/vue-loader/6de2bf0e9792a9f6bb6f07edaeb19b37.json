{"remainingRequest":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\src\\components\\Book\\BookInfo.vue?vue&type=style&index=0&id=1559d586&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\src\\components\\Book\\BookInfo.vue","mtime":1578117510863},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\less-loader\\dist\\cjs.js","mtime":1576755764101},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n.author{text-decoration:none;}\r\n",{"version":3,"sources":["BookInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BookInfo.vue","sourceRoot":"src/components/Book","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 导航 -->\r\n    <Breadcrumb :value=\"common\"></Breadcrumb>\r\n    <el-card class=\"box-card\">\r\n      <el-row class=\"checking\">\r\n        <el-col :span=\"20\">\r\n          <div class=\"grid-content bg-purple\">\r\n            <span class=\"com_title\">Title of book：</span>\r\n            <el-input\r\n              class=\"codeName\"\r\n              ref=\"com_name\"\r\n              placeholder=\"Please enter the title\"\r\n              v-model=\"input1\"\r\n              size=\"small\"\r\n              clearable\r\n              @clear=\"clear\"\r\n            ></el-input>\r\n            <span class=\"com_title\">Book bar code：</span>\r\n            <el-input\r\n              class=\"codeName\"\r\n              ref=\"com_code\"\r\n              placeholder=\"Please enter barcode\"\r\n              v-model=\"value1\"\r\n              size=\"small\"\r\n              clearable\r\n              @clear=\"clear\"\r\n            ></el-input>\r\n            <el-button type=\"info\" size=\"small\" @click=\"searchClick\">Query</el-button>\r\n            <!-- //查询 -->\r\n            <el-button plain size=\"small\" @click=\"reset\">Reset</el-button>\r\n            <!-- // 重置 -->\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div class=\"grid-content bg-purple-light\">\r\n            <el-button\r\n              type=\"info\"\r\n              size=\"small\"\r\n              @click=\"dialogFormVisible = true\"\r\n              class=\"add\"\r\n            >Add new book</el-button>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-table :data=\"tableData\" style=\"width: 100%\">\r\n        <el-table-column prop=\"title\" label=\"Title of book\">\r\n          <template slot-scope=\"scope\">\r\n            <a href=\"javascript:;\" class=\"author\" @click=\"openBook(scope.row.id)\">{{scope.row.title}}</a>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"isbn\" label=\"Book bar code\"></el-table-column>\r\n        <el-table-column label=\"Book author\">\r\n          <template slot-scope=\"scope\">\r\n            <a href=\"javascript:;\" class=\"author\" @click=\"open(scope.row.authorId)\">{{scope.row.name}}</a>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createdAt\" label=\"date\"></el-table-column>\r\n        <el-table-column label=\"Operation\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">Edit</el-button>\r\n            <!-- 编辑 -->\r\n            <el-button\r\n              size=\"mini\"\r\n              type=\"danger\"\r\n              @click=\"handleDelete(scope.$index, scope.row)\"\r\n            >Delete</el-button>\r\n            <!-- 删除 -->\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <el-pagination\r\n        v-if=\"show\"\r\n        class=\"page_size\"\r\n        background=\"\"\r\n        layout=\"prev, pager, next\"\r\n        :page-size=\"pageSize\"\r\n        :current-page=\"currentPage\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :total=\"allCount\"\r\n      ></el-pagination>\r\n      <el-dialog title=\"add book\" :visible.sync=\"dialogFormVisible\">\r\n        <el-form :model=\"addForm\" :rules=\"rules\" ref=\"addForm\">\r\n          <el-form-item label=\"book title\" prop=\"title\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.title\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"number\" prop=\"isbn\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.isbn\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"author\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.name\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialogFormVisible = false\">cancel</el-button>\r\n          <el-button size=\"small\" type=\"info\" @click=\"submitForm('addForm')\">confirm</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <el-dialog title=\"edit\" :visible.sync=\"editFormVisible\">\r\n        <el-form :model=\"editRegion\" :rules=\"rules\" ref=\"editRegion\">\r\n          <el-form-item label=\"book title\" prop=\"title\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.title\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"number\" prop=\"isbn\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.isbn\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"author\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.name\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click.native=\"editFormVisible = false\">edit</el-button>\r\n          <el-button size=\"small\" type=\"info\" @click=\"editSubmitRegion('editRegion')\">confirm</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <!-- //根据作者获取作品 -->\r\n      <el-dialog title=\"information\" :visible.sync=\"dialoginfo\">\r\n        <el-table :data=\"gridData\">\r\n          <el-table-column property=\"id\" label=\"id\"></el-table-column>\r\n          <el-table-column property=\"title\" label=\"book title\"></el-table-column>\r\n          <el-table-column property=\"isbn\" label=\"number\"></el-table-column>\r\n        </el-table>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialoginfo = false\">cancel</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <!-- //根据书名获取信息 -->\r\n      <el-dialog title=\"detailed information\" :visible.sync=\"dialogBookinfo\">\r\n        <el-table :data=\"bookData\">\r\n          <el-table-column property=\"title\" label=\"Title\"></el-table-column>\r\n          <el-table-column property=\"isbn\" label=\"ISBN\"></el-table-column>\r\n          <el-table-column property=\"name\" label=\"Author\"></el-table-column>\r\n        </el-table>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialogBookinfo = false\">cancel</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { books_api, getBooks_api,upBooks_api,addBooks_api,deleteBooks_api,getAuthorinfo,getBookinfo } from '@/api'\r\nimport moment from 'moment' // 时间过滤插件\r\nexport default {\r\n  data() {\r\n    return {\r\n      common: ['Book Info'], // 公共组件传值\r\n      input1: '',\r\n      value1: '',\r\n      allCount:null,\r\n      currentPage:1,\r\n      pageSize:10,\r\n      tableData: [],\r\n      gridData:[],\r\n      bookData: [],\r\n      dialogFormVisible:false,\r\n\t  editFormVisible: false,\r\n    dialoginfo:false,\r\n    dialogBookinfo: false,\r\n    show:true,\r\n\t  addForm: {\r\n\t  \ttitle: '',\r\n\t  \tisbn: '',\r\n\t  \tname: ''\r\n\t  },\r\n\t  editRegion: {\r\n\t  \ttitle: '',\r\n\t  \tisbn: '',\r\n\t  \tname: ''\r\n\t  },\r\n\t  formLabelWidth: '140px',\r\n\t  rules: {\r\n        title: [{ required: true, message: 'please input title', trigger: 'blur' }],\r\n\t  \tisbn: [{ required: true, message: 'please input number', trigger: 'blur' },\r\n          { type: 'string',\r\n            pattern: /^[0-9]{1,22}$/, // 正则表达式验证\r\n            message: 'Please enter a number number！',\r\n            trigger: 'blur'\r\n          }],\r\n\t  \tname: [{ required: true, message: 'please input author', trigger: 'blur' }]\r\n\t  }\r\n    }\r\n  },\r\n  filters: {\r\n    formatDate: function (value) {\r\n      return moment(value).format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  created() {\r\n    this.getBookAll()\r\n  },\r\n  methods: {\r\n    // 清除clearInput\r\n    clear(){\r\n      this.show = true;\r\n        this.getBookAll()\r\n    },\r\n    //获取图书信息\r\n    openBook(id) {\r\n      var params = {\r\n        id:id\r\n      }\r\n      getBookinfo(params).then(res=>{\r\n        if(res.status == 200){\r\n          this.dialogBookinfo=true;\r\n          this.bookData = res.data.data\r\n        }\r\n      }).catch(err=>{console.log(err)})\r\n    },\r\n    //获取作者信息\r\n    open(id) {\r\n      var params = {\r\n        id:id\r\n      }\r\n      getAuthorinfo(params).then(res=>{\r\n        if(res.status == 200){\r\n          this.dialoginfo=true;\r\n          this.gridData = res.data.data\r\n        }\r\n      }).catch(err=>{console.log(err)})\r\n    },\r\n\r\n    async getBookAll() {\r\n      // 刷新home页面就请求图书信息\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await books_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      for (var i in res.data) {\r\n        res.data[i].createdAt = moment(res.data[i].createdAt).format('YYYY-MM-DD')\r\n      }\r\n\t\t\t// console.log(res)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n    //分页\r\n    async handleCurrentChange(currentPage){\r\n      this.currentPage = currentPage;\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await books_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      for (var i in res.data) {\r\n        res.data[i].createdAt = moment(res.data[i].createdAt).format('YYYY-MM-DD')\r\n      }\r\n      // console.log(res)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n\t  reset() { // 重置功能\r\n\t  \tthis.input1 = '',\r\n\t  \tthis.value1 = ''\r\n\t  },\r\n    //add\r\n    submitForm(formName){\r\n        var that = this\r\n    \tthis.$refs[formName].validate((valid) =>{\r\n    \t\tif(valid){\r\n    \t\t\tvar params ={\r\n            \"bookTitle\": that.addForm.title,\r\n            \"bookIsbn\":that.addForm.isbn,\r\n            \"authorName\":that.addForm.name\r\n          }\r\n    \t\t\tthis.$confirm('Whether to commit',{\r\n    \t\t\t\tconfirmButtonText:'confirm',\r\n    \t\t\t\tcancelButtonText:'cancel',\r\n    \t\t\t\ttype:'warning',\r\n    \t\t\t\tcenter:true\r\n    \t\t\t})\r\n    \t\t\t.then(function(){\r\n    \t\t\t\t//ajax\r\n    \t\t\t\taddBooks_api(params).then(res =>{\r\n    \t\t\t\t\tif(res.data.status === 200){ //此处的表单验证\r\n    \t\t\t\t\t\tthat.dialogFormVisible = false\r\n    \t\t\t\t\t\tthat.getBookAll() //重新渲染数据\r\n    \t\t\t\t\t}else{\r\n    \t\t\t\t\tthat.$confirm(res.result.msg, 'hint', {\r\n                      type: 'warning'\r\n                 \t})\r\n    \t\t\t\t}\r\n    \t\t\t\t}).catch(err =>{console.log(err)})\r\n    \t\t\t})\r\n    \t\t\t.catch(function(err){\r\n    \t\t\t\tconsole.log('Cancel')\r\n    \t\t\t})\r\n    \t\t} else {\r\n    \t\t\treturn false\r\n    \t\t}\r\n    \t})\r\n    },\r\n\t  // edit\r\n\t  handleEdit(index, row) {\r\n\t      this.editFormVisible = true\r\n\t      this.editRegion = Object.assign({}, row) // 这句是关键！！！\r\n\t  },\r\n\t  editSubmitRegion (formName) {\r\n\t  \tvar that = this\r\n\t  \tthis.$refs[formName].validate((valid) => {\r\n\t  \t\tif (valid) {\r\n\t  \t\tvar params ={\r\n          \"bookId\":that.editRegion.id,\r\n          \"authorName\":that.editRegion.name,\r\n          \"bookTitle\":that.editRegion.title,\r\n          \"bookIsbn\":that.editRegion.isbn\r\n        }\r\n        // console.log(params)\r\n\t  \t\t\tthis.$confirm('Whether to commit',{\r\n\t  \t\t\t\tconfirmButtonText:'confirm',\r\n\t  \t\t\t\tcancelButtonText:'cancel',\r\n\t  \t\t\t\ttype:'warning',\r\n\t  \t\t\t\tcenter:true\r\n\t  \t\t\t})\r\n\t  \t\t\t.then(function(){\r\n\t  \t\t\t\t//ajax\r\n\t  \t\t\t\tupBooks_api(params).then(res =>{\r\n              console.log(res.data.status)\r\n\t  \t\t\t\t\tif(res.data.status === 200){\r\n\t  \t\t\t\t\t\tthat.editFormVisible = false\r\n\t  \t\t\t\t\t\tthat.getBookAll() //重新渲染数据\r\n\t  \t\t\t\t\t}else if(res.result.status == 2){\r\n\t  \t\t\t\t\t\tthat.$confirm(res.result.msg, 'hint', {\r\n\t                    type: 'warning'\r\n\t               \t})\r\n\t  \t\t\t\t\t}\r\n\t  \t\t\t\t}).catch(err =>{console.log(err)})\r\n\t  \t\t\t})\r\n\t  \t\t\t.catch(function(err){\r\n\t  \t\t\t\tconsole.log('Cancel')\r\n\t  \t\t\t})\r\n\t  \t\t} else {\r\n\t  \t\t\treturn false\r\n\t  \t\t}\r\n\t  \t})\r\n\t  },\r\n\t  // query\r\n\t  searchClick() { // 查询功能\r\n\t  \t// 获取当前页面的信息，发送给后台 刷新页面\r\n\r\n\t  \tconst nameCom = this.input1 // 书名\r\n\t  \tconst cardCom = this.value1 // 书名编号\r\n\r\n      if(nameCom == '' && cardCom == ''){\r\n        this.show = true;\r\n        this.getBookAll()\r\n      }else{\r\n        var  params = {\r\n          \"bookTitle\": nameCom,\r\n          \"bookIsbn\": parseInt(cardCom)\r\n        }\r\n        getBooks_api(params).then(res => {\r\n          if (res.data.status !== 200) {\r\n            return this.$message.error(res.data.msg)\r\n          } else {\r\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\r\n            var arr = []\r\n            arr.push(res.data.data)\r\n            this.tableData = arr\r\n            this.show = false;\r\n          }\r\n        })\r\n      }\r\n\t  },\r\n\t  // delete\r\n\t  handleDelete (index, row) {\r\n\t      var _self = this\r\n\t      this.$confirm('Are you sure to delete?', 'hint', {\r\n\t          confirmButtonText: 'delete',\r\n            cancelButtonText: 'waiting',\r\n            type: 'warning',\r\n            center: true\r\n              }).then(function() {\r\n            let params = {\r\n              bookId:row.id\r\n            }\r\n        deleteBooks_api({data:params}).then(res => {\r\n          console.log(res)\r\n        \tif(res.status == 200){\r\n        \t\t_self.$message({\r\n        \t\t  message: 'successfully delete',\r\n        \t\t  type: 'success'\r\n        \t  });\r\n        _self.getBookAll() //重新渲染数据\r\n        \t}\r\n        }).catch(err =>{console.log(err)})\r\n\t\t\t\t  }).catch(function(e) {\r\n\t\t\t\t\t  if (e != 'cancel') { console.log('error' + e) }\r\n\t\t\t\t  })\r\n\t\t  }\r\n  },\r\n  mounted() {\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n.author{text-decoration:none;}\r\n</style>\r\n"]}]}