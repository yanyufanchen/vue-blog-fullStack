{"remainingRequest":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\src\\components\\User\\UserInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\src\\components\\User\\UserInfo.vue","mtime":1578115287724},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\wangpeng\\\\Desktop\\\\mt\\\\vue-ht\\\\library\\\\my_library\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { allUser_api, getUser_api, addUser_api, editUser_api, deleteUser_api } from '@/api';\nimport moment from 'moment'; // 时间过滤插件\n\nexport default {\n  data: function data() {\n    return {\n      common: ['Reader information management'],\n      //公共组件传值\n      input1: '',\n      value1: '',\n      allCount: null,\n      currentPage: 1,\n      pageSize: 10,\n      tableData: [],\n      dialogFormVisible: false,\n      editFormVisible: false,\n      show: true,\n      addForm: {\n        name: '',\n        memberType: ''\n      },\n      editRegion: {\n        name: '',\n        memberType: ''\n      },\n      formLabelWidth: '140px',\n      rules: {\n        name: [{\n          required: true,\n          message: 'Please input the title',\n          trigger: 'blur'\n        }],\n        barcode: [{\n          required: true,\n          message: 'Please input number',\n          trigger: 'blur'\n        }, {\n          type: 'string',\n          pattern: /^[0-9]{1,22}$/,\n          //正则表达式验证\n          message: 'Please enter a number number！',\n          trigger: 'blur'\n        }],\n        memberType: [{\n          required: true,\n          message: 'Please input author',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.getUserAll();\n  },\n  methods: {\n    // 清除clearInput\n    clear: function clear() {\n      this.show = true;\n      this.getUserAll();\n    },\n    getUserAll: function () {\n      var _getUserAll = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var params, _ref, res;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                params = {\n                  \"pagesize\": this.pageSize,\n                  \"pageNO\": this.currentPage\n                };\n                _context.next = 3;\n                return allUser_api(params);\n\n              case 3:\n                _ref = _context.sent;\n                res = _ref.data;\n\n                if (!(res.status !== 200)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.$message.error(res.msg));\n\n              case 7:\n                this.tableData = res.data;\n                this.allCount = res.total;\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getUserAll() {\n        return _getUserAll.apply(this, arguments);\n      }\n\n      return getUserAll;\n    }(),\n    //分页\n    handleCurrentChange: function () {\n      var _handleCurrentChange = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(currentPage) {\n        var params, _ref2, res;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.currentPage = currentPage;\n                params = {\n                  \"pagesize\": this.pageSize,\n                  \"pageNO\": this.currentPage\n                };\n                _context2.next = 4;\n                return allUser_api(params);\n\n              case 4:\n                _ref2 = _context2.sent;\n                res = _ref2.data;\n\n                if (!(res.status !== 200)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this.$message.error(res.msg));\n\n              case 8:\n                this.tableData = res.data;\n                this.allCount = res.total;\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleCurrentChange(_x) {\n        return _handleCurrentChange.apply(this, arguments);\n      }\n\n      return handleCurrentChange;\n    }(),\n    //add\n    submitForm: function submitForm(formName) {\n      var _this = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = {\n            \"userName\": that.addForm.name,\n            \"memberType\": that.addForm.memberType\n          };\n\n          _this.$confirm('Whether to commit', {\n            confirmButtonText: 'confirm',\n            cancelButtonText: 'cancel',\n            type: 'warning',\n            center: true\n          }).then(function () {\n            //ajax\n            addUser_api(params).then(function (res) {\n              if (res.data.status == 200) {\n                //此处的表单验证\n                that.dialogFormVisible = false;\n                that.getUserAll(); //重新渲染数据\n              } else {\n                that.$confirm(res.data.msg, 'hint', {\n                  type: 'warning'\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            });\n          }).catch(function (err) {\n            console.log('Cancel');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //edit\n    handleEdit: function handleEdit(index, row) {\n      this.editFormVisible = true;\n      this.editRegion = Object.assign({\n        name: row.name,\n        barcode: row.barcode,\n        memberType: row.memberType,\n        userId: row.id\n      }); //这句是关键！！！\n    },\n    editSubmitRegion: function editSubmitRegion(formName) {\n      var _this2 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = {\n            userName: that.editRegion.name,\n            memberType: that.editRegion.memberType,\n            userId: that.editRegion.userId\n          };\n\n          _this2.$confirm('Whether to commit', {\n            confirmButtonText: 'confirm',\n            cancelButtonText: 'cancel',\n            type: 'warning',\n            center: true\n          }).then(function () {\n            //ajax\n            editUser_api(params).then(function (res) {\n              if (res.data.status == 200) {\n                that.editFormVisible = false;\n                that.getUserAll(); //重新渲染数据\n              } else {\n                that.$confirm(res.data.msg, 'hint', {\n                  type: 'warning'\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            });\n          }).catch(function (err) {\n            console.log('Cancel');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //query\n    searchClick: function searchClick() {\n      var _this3 = this;\n\n      // 查询功能\n      var nameCom = this.input1; //读者名字\n\n      var cardCom = this.value1; // 读者编号\n\n      if (nameCom == '' && cardCom == '') {\n        this.show = true;\n        this.getUserAll();\n      } else {\n        var params = {\n          \"userName\": nameCom,\n          \"userBarcode\": parseInt(cardCom)\n        };\n        getUser_api(params).then(function (res) {\n          if (res.data.status !== 200) {\n            return _this3.$message.error(res.data.msg);\n          } else {\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\n            var arr = [];\n            arr.push(res.data.data);\n            _this3.tableData = arr;\n            _this3.show = false;\n          }\n        });\n      }\n    },\n    //delete\n    handleDelete: function handleDelete(index, row) {\n      var _self = this;\n\n      this.$confirm('Are you sure to delete?', 'hint', {\n        confirmButtonText: 'delete',\n        cancelButtonText: 'waiting',\n        type: 'warning',\n        center: true\n      }).then(function () {\n        var params = {\n          userId: row.id\n        };\n        deleteUser_api({\n          data: params\n        }).then(function (res) {\n          if (res.status == 200) {\n            _self.$message({\n              message: 'successfully delete',\n              type: 'success'\n            });\n\n            _self.getUserAll(); //重新渲染数据\n\n          }\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }).catch(function (e) {\n        if (e != \"cancel\") console.log(\"error:\" + e);\n      });\n    }\n  },\n  mounted: function mounted() {}\n};",{"version":3,"sources":["UserInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA,SAAA,WAAA,EAAA,WAAA,EAAA,WAAA,EAAA,YAAA,EAAA,cAAA,QAAA,OAAA;AACA,OAAA,MAAA,MAAA,QAAA,C,CAAA;;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,CAAA,+BAAA,CADA;AACA;AACA,MAAA,MAAA,EAAA,EAFA;AAGA,MAAA,MAAA,EAAA,EAHA;AAIA,MAAA,QAAA,EAAA,IAJA;AAKA,MAAA,WAAA,EAAA,CALA;AAMA,MAAA,QAAA,EAAA,EANA;AAOA,MAAA,SAAA,EAAA,EAPA;AAQA,MAAA,iBAAA,EAAA,KARA;AASA,MAAA,eAAA,EAAA,KATA;AAUA,MAAA,IAAA,EAAA,IAVA;AAWA,MAAA,OAAA,EAAA;AACA,QAAA,IAAA,EAAA,EADA;AAEA,QAAA,UAAA,EAAA;AAFA,OAXA;AAeA,MAAA,UAAA,EAAA;AACA,QAAA,IAAA,EAAA,EADA;AAEA,QAAA,UAAA,EAAA;AAFA,OAfA;AAmBA,MAAA,cAAA,EAAA,OAnBA;AAoBA,MAAA,KAAA,EAAA;AACA,QAAA,IAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,wBAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,CADA;AAEA,QAAA,OAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,qBAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,EACA;AAAA,UAAA,IAAA,EAAA,QAAA;AACA,UAAA,OAAA,EAAA,eADA;AACA;AACA,UAAA,OAAA,EAAA,+BAFA;AAGA,UAAA,OAAA,EAAA;AAHA,SADA,CAFA;AAQA,QAAA,UAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,qBAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA;AARA;AApBA,KAAA;AA+BA,GAjCA;AAkCA,EAAA,OAlCA,qBAkCA;AACA,SAAA,UAAA;AACA,GApCA;AAqCA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,KAFA,mBAEA;AACA,WAAA,IAAA,GAAA,IAAA;AACA,WAAA,UAAA;AACA,KALA;AAMA,IAAA,UANA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAOA,gBAAA,MAPA,GAOA;AACA,8BAAA,KAAA,QADA;AAEA,4BAAA,KAAA;AAFA,iBAPA;AAAA;AAAA,uBAWA,WAAA,CAAA,MAAA,CAXA;;AAAA;AAAA;AAWA,gBAAA,GAXA,QAWA,IAXA;;AAAA,sBAYA,GAAA,CAAA,MAAA,KAAA,GAZA;AAAA;AAAA;AAAA;;AAAA,iDAYA,KAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,GAAA,CAZA;;AAAA;AAaA,qBAAA,SAAA,GAAA,GAAA,CAAA,IAAA;AACA,qBAAA,QAAA,GAAA,GAAA,CAAA,KAAA;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAgBA;AACA,IAAA,mBAjBA;AAAA;AAAA;AAAA,gDAiBA,WAjBA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAkBA,qBAAA,WAAA,GAAA,WAAA;AACA,gBAAA,MAnBA,GAmBA;AACA,8BAAA,KAAA,QADA;AAEA,4BAAA,KAAA;AAFA,iBAnBA;AAAA;AAAA,uBAuBA,WAAA,CAAA,MAAA,CAvBA;;AAAA;AAAA;AAuBA,gBAAA,GAvBA,SAuBA,IAvBA;;AAAA,sBAwBA,GAAA,CAAA,MAAA,KAAA,GAxBA;AAAA;AAAA;AAAA;;AAAA,kDAwBA,KAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,GAAA,CAxBA;;AAAA;AAyBA,qBAAA,SAAA,GAAA,GAAA,CAAA,IAAA;AACA,qBAAA,QAAA,GAAA,GAAA,CAAA,KAAA;;AA1BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA4BA;AACA,IAAA,UA7BA,sBA6BA,QA7BA,EA6BA;AAAA;;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,MAAA,GAAA;AACA,wBAAA,IAAA,CAAA,OAAA,CAAA,IADA;AAEA,0BAAA,IAAA,CAAA,OAAA,CAAA;AAFA,WAAA;;AAKA,UAAA,KAAA,CAAA,QAAA,CAAA,mBAAA,EAAA;AACA,YAAA,iBAAA,EAAA,SADA;AAEA,YAAA,gBAAA,EAAA,QAFA;AAGA,YAAA,IAAA,EAAA,SAHA;AAIA,YAAA,MAAA,EAAA;AAJA,WAAA,EAMA,IANA,CAMA,YAAA;AACA;AACA,YAAA,WAAA,CAAA,MAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,GAAA,CAAA,IAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AAAA;AACA,gBAAA,IAAA,CAAA,iBAAA,GAAA,KAAA;AACA,gBAAA,IAAA,CAAA,UAAA,GAFA,CAEA;AACA,eAHA,MAGA;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA,GAAA,CAAA,IAAA,CAAA,GAAA,EAAA,MAAA,EAAA;AACA,kBAAA,IAAA,EAAA;AADA,iBAAA;AAGA;AACA,aATA,EASA,KATA,CASA,UAAA,GAAA,EAAA;AAAA,cAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AAAA,aATA;AAUA,WAlBA,EAmBA,KAnBA,CAmBA,UAAA,GAAA,EAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,QAAA;AACA,WArBA;AAsBA,SA5BA,MA4BA;AACA,iBAAA,KAAA;AACA;AACA,OAhCA;AAiCA,KAhEA;AAiEA;AACA,IAAA,UAlEA,sBAkEA,KAlEA,EAkEA,GAlEA,EAkEA;AACA,WAAA,eAAA,GAAA,IAAA;AACA,WAAA,UAAA,GAAA,MAAA,CAAA,MAAA,CAAA;AAAA,QAAA,IAAA,EAAA,GAAA,CAAA,IAAA;AAAA,QAAA,OAAA,EAAA,GAAA,CAAA,OAAA;AAAA,QAAA,UAAA,EAAA,GAAA,CAAA,UAAA;AAAA,QAAA,MAAA,EAAA,GAAA,CAAA;AAAA,OAAA,CAAA,CAFA,CAEA;AACA,KArEA;AAsEA,IAAA,gBAtEA,4BAsEA,QAtEA,EAsEA;AAAA;;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,MAAA,GAAA;AACA,YAAA,QAAA,EAAA,IAAA,CAAA,UAAA,CAAA,IADA;AAEA,YAAA,UAAA,EAAA,IAAA,CAAA,UAAA,CAAA,UAFA;AAGA,YAAA,MAAA,EAAA,IAAA,CAAA,UAAA,CAAA;AAHA,WAAA;;AAKA,UAAA,MAAA,CAAA,QAAA,CAAA,mBAAA,EAAA;AACA,YAAA,iBAAA,EAAA,SADA;AAEA,YAAA,gBAAA,EAAA,QAFA;AAGA,YAAA,IAAA,EAAA,SAHA;AAIA,YAAA,MAAA,EAAA;AAJA,WAAA,EAMA,IANA,CAMA,YAAA;AACA;AACA,YAAA,YAAA,CAAA,MAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,kBAAA,GAAA,CAAA,IAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,gBAAA,IAAA,CAAA,eAAA,GAAA,KAAA;AACA,gBAAA,IAAA,CAAA,UAAA,GAFA,CAEA;AACA,eAHA,MAGA;AACA,gBAAA,IAAA,CAAA,QAAA,CAAA,GAAA,CAAA,IAAA,CAAA,GAAA,EAAA,MAAA,EAAA;AACA,kBAAA,IAAA,EAAA;AADA,iBAAA;AAGA;AACA,aATA,EASA,KATA,CASA,UAAA,GAAA,EAAA;AAAA,cAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AAAA,aATA;AAUA,WAlBA,EAmBA,KAnBA,CAmBA,UAAA,GAAA,EAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,QAAA;AACA,WArBA;AAsBA,SA5BA,MA4BA;AACA,iBAAA,KAAA;AACA;AACA,OAhCA;AAiCA,KAzGA;AA0GA;AACA,IAAA,WA3GA,yBA2GA;AAAA;;AAAA;AACA,UAAA,OAAA,GAAA,KAAA,MAAA,CADA,CACA;;AACA,UAAA,OAAA,GAAA,KAAA,MAAA,CAFA,CAEA;;AACA,UAAA,OAAA,IAAA,EAAA,IAAA,OAAA,IAAA,EAAA,EAAA;AACA,aAAA,IAAA,GAAA,IAAA;AACA,aAAA,UAAA;AACA,OAHA,MAGA;AACA,YAAA,MAAA,GAAA;AACA,sBAAA,OADA;AAEA,yBAAA,QAAA,CAAA,OAAA;AAFA,SAAA;AAIA,QAAA,WAAA,CAAA,MAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,cAAA,GAAA,CAAA,IAAA,CAAA,MAAA,KAAA,GAAA,EAAA;AACA,mBAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,CAAA,IAAA,CAAA,GAAA,CAAA;AACA,WAFA,MAEA;AACA;AACA,gBAAA,GAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,IAAA,CAAA,GAAA,CAAA,IAAA,CAAA,IAAA;AACA,YAAA,MAAA,CAAA,SAAA,GAAA,GAAA;AACA,YAAA,MAAA,CAAA,IAAA,GAAA,KAAA;AACA;AACA,SAVA;AAWA;AAEA,KAnIA;AAoIA;AACA,IAAA,YArIA,wBAqIA,KArIA,EAqIA,GArIA,EAqIA;AACA,UAAA,KAAA,GAAA,IAAA;;AACA,WAAA,QAAA,CAAA,yBAAA,EAAA,MAAA,EAAA;AACA,QAAA,iBAAA,EAAA,QADA;AAEA,QAAA,gBAAA,EAAA,SAFA;AAGA,QAAA,IAAA,EAAA,SAHA;AAIA,QAAA,MAAA,EAAA;AAJA,OAAA,EAKA,IALA,CAKA,YAAA;AACA,YAAA,MAAA,GAAA;AACA,UAAA,MAAA,EAAA,GAAA,CAAA;AADA,SAAA;AAGA,QAAA,cAAA,CAAA;AAAA,UAAA,IAAA,EAAA;AAAA,SAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,cAAA,GAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,YAAA,KAAA,CAAA,QAAA,CAAA;AACA,cAAA,OAAA,EAAA,qBADA;AAEA,cAAA,IAAA,EAAA;AAFA,aAAA;;AAIA,YAAA,KAAA,CAAA,UAAA,GALA,CAKA;;AACA;AACA,SARA,EAQA,KARA,CAQA,UAAA,GAAA,EAAA;AAAA,UAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AAAA,SARA;AASA,OAlBA,EAkBA,KAlBA,CAkBA,UAAA,CAAA,EAAA;AACA,YAAA,CAAA,IAAA,QAAA,EACA,OAAA,CAAA,GAAA,CAAA,WAAA,CAAA;AACA,OArBA;AAsBA;AA7JA,GArCA;AAoMA,EAAA,OApMA,qBAoMA,CAAA;AApMA,CAAA","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<!-- 导航 -->\r\n\t\t<Breadcrumb :value=\"common\"></Breadcrumb>\r\n\t\t<el-card class=\"box-card\">\r\n\t\t\t<el-row class=\"checking\">\r\n\t\t\t\t<el-col :span=\"19\">\r\n\t\t\t\t\t<div class=\"grid-content bg-purple\">\r\n\t\t\t\t\t\t<span class=\"com_title\">Reader name：</span>\r\n\t\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t\tclass=\"codeName\"\r\n\t\t\t\t\t\t\tref=\"com_name\"\r\n\t\t\t\t\t\t\tplaceholder=\"Please enter name\"\r\n\t\t\t\t\t\t\tv-model=\"input1\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tclearable\r\n\t\t\t\t\t\t\t@clear=\"clear\"\r\n\t\t\t\t\t\t></el-input>\r\n\t\t\t\t\t\t<span class=\"com_title\">Reader barcode：</span>\r\n\t\t\t\t\t\t<el-input\r\n\t\t\t\t\t\t\tclass=\"codeName\"\r\n\t\t\t\t\t\t\tref=\"com_name\"\r\n\t\t\t\t\t\t\tplaceholder=\"Please enter barcode\"\r\n\t\t\t\t\t\t\tv-model=\"value1\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@clear=\"clear\"\r\n\t\t\t\t\t\t\tclearable\r\n\t\t\t\t\t\t></el-input>\r\n\t\t\t\t\t\t<el-button type=\"info\" size=\"small\" @click=\"searchClick\">Query</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-col>\r\n\t\t\t\t<el-col :span=\"5\">\r\n\t\t\t\t\t<div class=\"grid-content bg-purple-light\">\r\n\t\t\t\t\t\t<el-button\r\n\t\t\t\t\t\t\ttype=\"info\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@click=\"dialogFormVisible = true\"\r\n\t\t\t\t\t\t\tclass=\"add\"\r\n\t\t\t\t\t\t>New reader information</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-col>\r\n\t\t\t</el-row>\r\n\t\t\t<el-table :data=\"tableData\" style=\"width: 100%\">\r\n\t\t\t\t<el-table-column prop=\"name\" label=\"Reader name\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"barcode\" label=\"Reader barcode\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"memberType\" label=\"Occupation\"></el-table-column>\r\n\t\t\t\t<el-table-column label=\"Operation\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-button size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">Edit</el-button>\r\n\t\t\t\t\t\t<el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.$index, scope.row)\">Delete</el-button>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<el-pagination\r\n\t\t\t\tv-if=\"show\"\r\n\t\t\t\tclass=\"page_size\"\r\n\t\t\t\tbackground=\"\"\r\n\t\t\t\tlayout=\"prev, pager, next\"\r\n\t\t\t\t:page-size=\"pageSize\"\r\n\t\t\t\t:current-page=\"currentPage\"\r\n\t\t\t\t@current-change=\"handleCurrentChange\"\r\n\t\t\t\t:total=\"allCount\"\r\n\t\t\t></el-pagination>\r\n\t\t\t<el-dialog title=\"add Reader\" :visible.sync=\"dialogFormVisible\">\r\n\t\t\t\t<el-form :model=\"addForm\" :rules=\"rules\" ref=\"addForm\">\r\n\t\t\t\t\t<el-form-item label=\"reader name\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"addForm.name\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"occupation\" prop=\"memberType\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"addForm.memberType\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t\t<el-button size=\"small\" @click=\"dialogFormVisible = false\">cancel</el-button>\r\n\t\t\t\t\t<el-button size=\"small\" type=\"info\" @click=\"submitForm('addForm')\">confirm</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t</el-dialog>\r\n\t\t\t<el-dialog title=\"edit\" :visible.sync=\"editFormVisible\">\r\n\t\t\t\t<el-form :model=\"editRegion\" :rules=\"rules\" ref=\"editRegion\">\r\n\t\t\t\t\t<el-form-item label=\"reader name\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"editRegion.name\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"occupation\" prop=\"memberType\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t<el-input v-model=\"editRegion.memberType\" autocomplete=\"off\" clearable></el-input>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t\t<el-button size=\"small\" @click.native=\"editFormVisible = false\">cancel</el-button>\r\n\t\t\t\t\t<el-button size=\"small\" type=\"info\" @click=\"editSubmitRegion('editRegion')\">confirm</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t</el-dialog>\r\n\t\t</el-card>\r\n\t</div>\r\n</template>\r\n<script>\r\n  import {allUser_api,getUser_api,addUser_api,editUser_api,deleteUser_api} from '@/api'\r\n  import moment from 'moment' // 时间过滤插件\r\nexport default {\r\n  data() {\r\n    return {\r\n      common: ['Reader information management'], //公共组件传值\r\n      input1:'',\r\n      value1:'',\r\n      allCount:null,\r\n        currentPage:1,\r\n        pageSize:10,\r\n        tableData: [],\r\n        dialogFormVisible:false,\r\n      editFormVisible: false,\r\n      show:true,\r\n\t\t\taddForm:{\r\n\t\t\t\tname:'',\r\n\t\t\t\tmemberType:'',\r\n\t\t\t},\r\n\t\t\teditRegion: {\r\n\t\t\t\tname:'',\r\n\t\t\t\tmemberType:''\r\n\t\t\t},\r\n\t\t\tformLabelWidth:'140px',\r\n\t\t\trules:{\r\n\t\t\t\tname:[{required:true,message:'Please input the title',trigger:'blur'}],\r\n\t\t\t\tbarcode:[{required:true,message:'Please input number',trigger:'blur'},\r\n\t\t\t\t\t\t\t{type: 'string',\r\n\t\t\t\t\t\t\tpattern:  /^[0-9]{1,22}$/,//正则表达式验证\r\n\t\t\t\t\t\t\tmessage: 'Please enter a number number！',\r\n\t\t\t\t\t\t\ttrigger: 'blur'\r\n\t\t\t\t\t\t}],\r\n\t\t\t\tmemberType:[{required:true,message:'Please input author',trigger:'blur'}]\r\n\t\t\t},\r\n    }\r\n  },\r\n  created() {\r\n    this.getUserAll()\r\n  },\r\n  methods: {\r\n\t  // 清除clearInput\r\n    clear(){\r\n      this.show = true;\r\n        this.getUserAll()\r\n    },\r\n    async getUserAll() {\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await allUser_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n    //分页\r\n    async handleCurrentChange(currentPage){\r\n      this.currentPage = currentPage;\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await allUser_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n\t\t//add\r\n\t\tsubmitForm(formName){\r\n\t\t    var that = this\r\n\t\t\tthis.$refs[formName].validate((valid) =>{\r\n\t\t\t\tif(valid){\r\n\t\t\t\t\tvar params ={\r\n            \"userName\": that.addForm.name,\r\n            \"memberType\": that.addForm.memberType\r\n          }\r\n\r\n\t\t\t\t\tthis.$confirm('Whether to commit',{\r\n\t\t\t\t\t\tconfirmButtonText:'confirm',\r\n\t\t\t\t\t\tcancelButtonText:'cancel',\r\n\t\t\t\t\t\ttype:'warning',\r\n\t\t\t\t\t\tcenter:true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(function(){\r\n\t\t\t\t\t\t//ajax\r\n\t\t\t\t\t\taddUser_api(params).then(res =>{\r\n\t\t\t\t\t\t\tif(res.data.status == 200){ //此处的表单验证\r\n\t\t\t\t\t\t\t\tthat.dialogFormVisible = false\r\n\t\t\t\t\t\t\t\tthat.getUserAll() //重新渲染数据\r\n\t\t\t\t\t\t\t}else{\r\n                that.$confirm(res.data.msg, 'hint', {\r\n\t\t                  type: 'warning'\r\n\t\t            })\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).catch(err =>{console.log(err)})\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(function(err){\r\n\t\t\t\t\t\tconsole.log('Cancel')\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//edit\r\n\t\thandleEdit(index, row) {\r\n\t\t    this.editFormVisible = true;\r\n\t\t    this.editRegion = Object.assign({name: row.name,barcode:row.barcode,memberType: row.memberType,userId: row.id}); //这句是关键！！！\r\n\t\t},\r\n\t\teditSubmitRegion (formName) {\r\n\t\t\tvar that = this\r\n\t\t\tthis.$refs[formName].validate((valid) =>{\r\n\t\t\t\tif(valid){\r\n          var params ={\r\n            userName: that.editRegion.name,\r\n            memberType: that.editRegion.memberType,\r\n            userId: that.editRegion.userId\r\n          }\r\n\t\t\t\t\tthis.$confirm('Whether to commit',{\r\n\t\t\t\t\t\tconfirmButtonText:'confirm',\r\n\t\t\t\t\t\tcancelButtonText:'cancel',\r\n\t\t\t\t\t\ttype:'warning',\r\n\t\t\t\t\t\tcenter:true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(function(){\r\n\t\t\t\t\t\t//ajax\r\n\t\t\t\t\t\teditUser_api(params).then(res =>{\r\n\t\t\t\t\t\t\tif(res.data.status == 200){\r\n\t\t\t\t\t\t\t\tthat.editFormVisible = false\r\n\t\t\t\t\t\t\t\tthat.getUserAll() //重新渲染数据\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthat.$confirm(res.data.msg, 'hint', {\r\n\t\t                  type: 'warning'\r\n\t\t             \t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).catch(err =>{console.log(err)})\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(function(err){\r\n\t\t\t\t\t\tconsole.log('Cancel')\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t//query\r\n\t\tsearchClick(){ // 查询功能\r\n\t\t\tconst nameCom = this.input1; //读者名字\r\n\t\t\tconst cardCom = this.value1; // 读者编号\r\n      if(nameCom == '' && cardCom == ''){\r\n        this.show = true;\r\n        this.getUserAll()\r\n      }else{\r\n        var  params = {\r\n          \"userName\": nameCom,\r\n          \"userBarcode\": parseInt(cardCom)\r\n        }\r\n        getUser_api(params).then(res => {\r\n          if (res.data.status !== 200) {\r\n            return this.$message.error(res.data.msg)\r\n          } else {\r\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\r\n            var arr = []\r\n            arr.push(res.data.data)\r\n            this.tableData = arr\r\n            this.show = false;\r\n          }\r\n        })\r\n      }\r\n\r\n\t\t},\r\n\t\t//delete\r\n\t\thandleDelete (index,row) {\r\n\t\t    var _self = this;\r\n\t\t    this.$confirm('Are you sure to delete?', 'hint', {\r\n\t\t        confirmButtonText:'delete',\r\n\t\t\t\t\t  cancelButtonText:'waiting',\r\n\t\t\t\t\t  type:'warning',\r\n\t\t\t\t\t  center:true\r\n\t\t\t\t\t\t  }).then(function(){\r\n\t\t\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\t\t\tuserId:row.id\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdeleteUser_api({data:params}).then(res => {\r\n\t\t\t\t\t\t\t\tif(res.status == 200){\r\n\t\t\t\t\t\t\t\t\t_self.$message({\r\n\t\t\t\t\t\t\t\t\t  message: 'successfully delete',\r\n\t\t\t\t\t\t\t\t\t  type: 'success'\r\n\t\t\t\t\t\t\t\t  });\r\n\t\t\t\t\t\t\t_self.getUserAll() //重新渲染数据\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err =>{console.log(err)})\r\n\t\t\t\t\t\t  }).catch(function(e){\r\n\t\t\t\t\t\t\t  if(e != \"cancel\")\r\n\t\t\t\t\t\t\t\t  console.log(\"error:\" + e);\r\n\t\t\t\t\t\t  });\r\n\t\t\t\t  },\r\n\t},\r\n  mounted() {}\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n</style>\r\n"],"sourceRoot":"src/components/User"}]}