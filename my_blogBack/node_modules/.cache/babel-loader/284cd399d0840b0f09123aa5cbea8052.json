{"remainingRequest":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\babel-loader\\lib\\index.js!D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\src\\components\\BorrowCard\\BorrowCard.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\src\\components\\BorrowCard\\BorrowCard.vue","mtime":1578115300762},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\开发\\个人服务器\\pengwang.xyz\\my_blogBack\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\\\u5F00\\u53D1\\\\\\u4E2A\\u4EBA\\u670D\\u52A1\\u5668\\\\pengwang.xyz\\\\my_blogBack\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { alllibraryCard_api, getlibraryCard_api, addlibraryCard_api, editlibraryCard_api, deletelibraryCard_api } from '@/api';\nexport default {\n  data: function data() {\n    return {\n      common: ['Borrow card management'],\n      //公共组件传值\n      input1: '',\n      value1: '',\n      tableData: [],\n      dialogFormVisible: false,\n      editFormVisible: false,\n      addForm: {\n        barcode: '',\n        name: ''\n      },\n      editRegion: {\n        barcode: '',\n        name: ''\n      },\n      formLabelWidth: '140px',\n      rules: {\n        barcode: [{\n          required: true,\n          message: 'Please input card number',\n          trigger: 'blur'\n        }, {\n          type: 'string',\n          pattern: /^[0-9]{1,22}$/,\n          // 正则表达式验证\n          message: 'Please enter a number number！',\n          trigger: 'blur'\n        }],\n        name: [{\n          required: true,\n          message: 'Please input author',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.getBorrowCardAll();\n  },\n  methods: {\n    // 清除clearInput\n    clear: function clear() {\n      this.show = true;\n      this.getBorrowCardAll();\n    },\n    getBorrowCardAll: function () {\n      var _getBorrowCardAll = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _ref, res;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return alllibraryCard_api();\n\n              case 2:\n                _ref = _context.sent;\n                res = _ref.data;\n\n                if (!(res.status !== 200)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.$message.error(res.msg));\n\n              case 6:\n                this.tableData = res.data;\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getBorrowCardAll() {\n        return _getBorrowCardAll.apply(this, arguments);\n      }\n\n      return getBorrowCardAll;\n    }(),\n    //query 查询\n    searchClick: function searchClick() {\n      var _this = this;\n\n      var nameCom = this.input1; // 姓名\n\n      var cardCom = this.value1; // 编号\n\n      if (nameCom == '' && cardCom == '') {\n        this.show = true;\n        this.getBorrowCardAll();\n      } else {\n        var params = {\n          \"name\": nameCom,\n          \"barcode\": cardCom\n        };\n        getBorrowCard_api(params).then(function (res) {\n          if (res.data.status !== 200) {\n            return _this.$message.error(res.data.msg);\n          } else {\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\n            var arr = [];\n            arr.push(res.data.data);\n            _this.tableData = arr;\n          }\n        });\n      }\n    },\n    // edit\n    handleEdit: function handleEdit(index, row) {\n      this.editFormVisible = true;\n      this.editRegion = Object.assign({\n        id: row.id\n      }, row); // 这句是关键！！！\n    },\n    editSubmitRegion: function editSubmitRegion(formName) {\n      var _this2 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = {\n            \"id\": that.editRegion.id,\n            \"name\": that.editRegion.name,\n            \"barcode\": that.editRegion.barcode\n          };\n\n          _this2.$confirm('Whether to commit', {\n            confirmButtonText: 'confirm',\n            cancelButtonText: 'cancel',\n            type: 'warning',\n            center: true\n          }).then(function () {\n            //ajax\n            editlibraryCard_api(params).then(function (res) {\n              if (res.status === 200) {\n                that.editFormVisible = false;\n                that.getBorrowCardAll(); //重新渲染数据\n              } else if (res.result.status == 2) {\n                that.$confirm(res.result.msg, 'hint', {\n                  type: 'warning'\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            });\n          }).catch(function (err) {\n            console.log('Cancel');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //add 添加\n    submitForm: function submitForm(formName) {\n      var _this3 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = {\n            \"name\": that.addForm.name,\n            \"barcode\": that.addForm.barcode\n          };\n\n          _this3.$confirm('Whether to commit', {\n            confirmButtonText: 'confirm',\n            cancelButtonText: 'cancel',\n            type: 'warning',\n            center: true\n          }).then(function () {\n            //ajax\n            addlibraryCard_api(params).then(function (res) {\n              if (res.status === 200) {\n                //此处的表单验证\n                that.dialogFormVisible = false;\n                that.getBorrowCardAll(); //重新渲染数据\n              } else {\n                that.$confirm(res.result.msg, 'hint', {\n                  type: 'warning'\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            });\n          }).catch(function (err) {\n            console.log('Cancel');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    // delete\n    handleDelete: function handleDelete(index, row) {\n      var _self = this;\n\n      this.$confirm('Are you sure to delete?', 'hint', {\n        confirmButtonText: 'delete',\n        cancelButtonText: 'waiting',\n        type: 'warning',\n        center: true\n      }).then(function () {\n        var params = {\n          bCardId: row.id\n        };\n        deletelibraryCard_api({\n          data: params\n        }).then(function (res) {\n          if (res.status == 200) {\n            _self.$message({\n              message: 'successfully delete',\n              type: 'success'\n            });\n\n            _self.getBorrowCardAll(); //重新渲染数据\n\n          }\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }).catch(function (e) {\n        if (e != 'cancel') {\n          console.log('error' + e);\n        }\n      });\n    }\n  },\n  mounted: function mounted() {}\n};",{"version":3,"sources":["BorrowCard.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 导航 -->\r\n    <Breadcrumb :value=\"common\"></Breadcrumb>\r\n    <el-card class=\"box-card\">\r\n      <!-- //借书证 -->\r\n      <el-row class=\"checking\">\r\n        <el-col :span=\"18\">\r\n          <div class=\"grid-content bg-purple\">\r\n            <span class=\"com_title\">read name：</span>\r\n            <el-input\r\n              class=\"codeName\"\r\n              ref=\"com_name\"\r\n              placeholder=\"Please enter read name\"\r\n              v-model=\"input1\"\r\n              size=\"small\"\r\n              clearable\r\n              @clear=\"clear\"\r\n            ></el-input>\r\n            <span class=\"com_title\">card No：</span>\r\n            <el-input\r\n              class=\"codeName\"\r\n              ref=\"com_name\"\r\n              placeholder=\"Please enter card No\"\r\n              v-model=\"value1\"\r\n              size=\"small\"\r\n              clearable\r\n              @clear=\"clear\"\r\n            ></el-input>\r\n            <el-button type=\"info\" size=\"small\" @click=\"searchClick\">Query</el-button>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <div class=\"grid-content bg-purple-light\">\r\n            <el-button\r\n              type=\"info\"\r\n              size=\"small\"\r\n              @click=\"dialogFormVisible = true\"\r\n              class=\"add\"\r\n            >Add administrator</el-button>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-table :data=\"tableData\" style=\"width: 100%\">\r\n        <el-table-column prop=\"id\" label=\"Order\"></el-table-column>\r\n        <el-table-column prop=\"name\" label=\"Borrower\"></el-table-column>\r\n        <el-table-column prop=\"barcode\" label=\"Borrower No\"></el-table-column>\r\n        <el-table-column label=\"Operation\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">Edit</el-button>\r\n            <el-button\r\n              size=\"mini\"\r\n              type=\"danger\"\r\n              @click=\"handleDelete(scope.$index, scope.row)\"\r\n            >Delete</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <el-dialog title=\"Add a library card\" :visible.sync=\"dialogFormVisible\">\r\n        <el-form :model=\"addForm\" :rules=\"rules\" ref=\"addForm\">\r\n          <el-form-item label=\"card name\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.name\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"card number\" prop=\"barcode\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.barcode\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialogFormVisible = false\">cancel</el-button>\r\n          <el-button size=\"small\" type=\"info\" @click=\"submitForm('addForm')\">confirm</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <el-dialog title=\"edit a library card\" :visible.sync=\"editFormVisible\">\r\n        <el-form :model=\"editRegion\" :rules=\"rules\" ref=\"editRegion\">\r\n          <el-form-item label=\"card name\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.name\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"card number\" prop=\"barcode\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.barcode\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click.native=\"editFormVisible = false\">cancel</el-button>\r\n          <el-button size=\"small\" type=\"info\" @click=\"editSubmitRegion('editRegion')\">confirm</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n<script>\r\n  import { alllibraryCard_api, getlibraryCard_api,addlibraryCard_api,editlibraryCard_api,deletelibraryCard_api } from '@/api'\r\nexport default {\r\n  data() {\r\n    return {\r\n      common: ['Borrow card management'], //公共组件传值\r\n      input1:'',\r\n      value1:'',\r\n      tableData: [],\r\n      dialogFormVisible:false,\r\n      editFormVisible: false,\r\n      addForm: {\r\n      \tbarcode: '',\r\n      \tname: ''\r\n      },\r\n      editRegion: {\r\n      \tbarcode: '',\r\n      \tname: ''\r\n      },\r\n      formLabelWidth: '140px',\r\n      rules: {\r\n      \tbarcode: [{ required: true, message: 'Please input card number', trigger: 'blur' },\r\n            { type: 'string',\r\n              pattern: /^[0-9]{1,22}$/, // 正则表达式验证\r\n              message: 'Please enter a number number！',\r\n              trigger: 'blur'\r\n            }],\r\n      \tname: [{ required: true, message: 'Please input author', trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.getBorrowCardAll()\r\n  },\r\n  methods: {\r\n    // 清除clearInput\r\n    clear(){\r\n      this.show = true;\r\n        this.getBorrowCardAll()\r\n    },\r\n    async getBorrowCardAll() {\r\n\r\n      const { data: res } = await alllibraryCard_api()\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      this.tableData = res.data\r\n    },\r\n    //query 查询\r\n    searchClick(){\r\n       const nameCom = this.input1 // 姓名\r\n       const cardCom = this.value1 // 编号\r\n\r\n       if(nameCom == '' && cardCom == ''){\r\n         this.show = true;\r\n         this.getBorrowCardAll()\r\n       }else{\r\n         var  params = {\r\n           \"name\": nameCom,\r\n           \"barcode\": cardCom\r\n         }\r\n         getBorrowCard_api(params).then(res => {\r\n           if (res.data.status !== 200) {\r\n             return this.$message.error(res.data.msg)\r\n           } else {\r\n             // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\r\n             var arr = []\r\n             arr.push(res.data.data)\r\n             this.tableData = arr\r\n           }\r\n         })\r\n       }\r\n    },\r\n    // edit\r\n    handleEdit(index, row) {\r\n        this.editFormVisible = true\r\n        this.editRegion = Object.assign({id:row.id}, row) // 这句是关键！！！\r\n    },\r\n    editSubmitRegion (formName) {\r\n    \tvar that = this\r\n    \tthis.$refs[formName].validate((valid) => {\r\n    \t\tif (valid) {\r\n    \t\tvar params ={\r\n          \"id\":that.editRegion.id,\r\n    \t\t  \"name\": that.editRegion.name,\r\n    \t\t  \"barcode\":that.editRegion.barcode,\r\n    \t\t}\r\n    \t\t\tthis.$confirm('Whether to commit',{\r\n    \t\t\t\tconfirmButtonText:'confirm',\r\n    \t\t\t\tcancelButtonText:'cancel',\r\n    \t\t\t\ttype:'warning',\r\n    \t\t\t\tcenter:true\r\n    \t\t\t})\r\n    \t\t\t.then(function(){\r\n    \t\t\t\t//ajax\r\n    \t\t\t\teditlibraryCard_api(params).then(res =>{\r\n    \t\t\t\t\tif(res.status === 200){\r\n    \t\t\t\t\t\tthat.editFormVisible = false\r\n    \t\t\t\t\t\tthat.getBorrowCardAll() //重新渲染数据\r\n    \t\t\t\t\t}else if(res.result.status == 2){\r\n    \t\t\t\t\t\tthat.$confirm(res.result.msg, 'hint', {\r\n                      type: 'warning'\r\n                 \t})\r\n    \t\t\t\t\t}\r\n    \t\t\t\t}).catch(err =>{console.log(err)})\r\n    \t\t\t})\r\n    \t\t\t.catch(function(err){\r\n    \t\t\t\tconsole.log('Cancel')\r\n    \t\t\t})\r\n    \t\t} else {\r\n    \t\t\treturn false\r\n    \t\t}\r\n    \t})\r\n    },\r\n    //add 添加\r\n    submitForm(formName){\r\n        var that = this\r\n    \tthis.$refs[formName].validate((valid) =>{\r\n    \t\tif(valid){\r\n    \t\t\tvar params ={\r\n            \"name\": that.addForm.name,\r\n            \"barcode\":that.addForm.barcode,\r\n          }\r\n    \t\t\tthis.$confirm('Whether to commit',{\r\n    \t\t\t\tconfirmButtonText:'confirm',\r\n    \t\t\t\tcancelButtonText:'cancel',\r\n    \t\t\t\ttype:'warning',\r\n    \t\t\t\tcenter:true\r\n    \t\t\t})\r\n    \t\t\t.then(function(){\r\n    \t\t\t\t//ajax\r\n    \t\t\t\taddlibraryCard_api(params).then(res =>{\r\n    \t\t\t\t\tif(res.status === 200){ //此处的表单验证\r\n    \t\t\t\t\t\tthat.dialogFormVisible = false\r\n    \t\t\t\t\t\tthat.getBorrowCardAll() //重新渲染数据\r\n    \t\t\t\t\t}else{\r\n    \t\t\t\t\tthat.$confirm(res.result.msg, 'hint', {\r\n                      type: 'warning'\r\n                 \t})\r\n    \t\t\t\t}\r\n    \t\t\t\t}).catch(err =>{console.log(err)})\r\n    \t\t\t})\r\n    \t\t\t.catch(function(err){\r\n    \t\t\t\tconsole.log('Cancel')\r\n    \t\t\t})\r\n    \t\t} else {\r\n    \t\t\treturn false\r\n    \t\t}\r\n    \t})\r\n    },\r\n    // delete\r\n    handleDelete (index, row) {\r\n        var _self = this\r\n        this.$confirm('Are you sure to delete?', 'hint', {\r\n            confirmButtonText: 'delete',\r\n            cancelButtonText: 'waiting',\r\n            type: 'warning',\r\n            center: true\r\n              }).then(function() {\r\n            let params = {\r\n              bCardId:row.id\r\n            }\r\n        deletelibraryCard_api({data:params}).then(res => {\r\n        \tif(res.status == 200){\r\n        \t\t_self.$message({\r\n        \t\t  message: 'successfully delete',\r\n        \t\t  type: 'success'\r\n        \t  });\r\n        _self.getBorrowCardAll() //重新渲染数据\r\n        \t}\r\n        }).catch(err =>{console.log(err)})\r\n    \t\t  }).catch(function(e) {\r\n    \t\t\t  if (e != 'cancel') { console.log('error' + e) }\r\n    \t\t  })\r\n      }\r\n\r\n  },\r\n  mounted() {\r\n\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n</style>\r\n"],"sourceRoot":"src/components/BorrowCard"}]}